<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Профиль пользователя</title>
</head>
<body>

<h1 th:text="'Добро пожаловать, ' + ${user.username} + '!'">
    Добро пожаловать, user!
</h1>

<p>Роль:
    <span th:text="${user.role}">ROLE_USER</span>
</p>

<p>
    Дата регистрации:
    <span th:text="${user.createdAt}">2025-01-01T00:00:00</span>
</p>

<p>
    Количество посещений:
    <span th:text="${visitCount}">0</span>
</p>

<p>
    Время сервера:
    <span th:text="${serverTime}">2025-01-01T00:00:00</span>
</p>

<hr/>

<nav>
    <!-- Мои товары (для авторизованных ролей) -->
    <a th:href="@{/user/fuel}">Мои товары (топливо)</a><br/>

    <a th:href="@{/}">На главную</a><br/>
    <a th:href="@{/logout}">Выйти</a>
</nav>

<hr/>

<h2>Изменить логин</h2>
<form th:action="@{/profile/username}" method="post">
    <input type="text" name="username" th:value="${user.username}"/>
    <button type="submit">Сохранить</button>
</form>

<hr/>

<h2>Сменить пароль</h2>
<form th:action="@{/profile/password}" method="post">
    <input type="password" name="oldPassword" placeholder="Старый пароль"/><br/>
    <input type="password" name="newPassword" placeholder="Новый пароль"/><br/>
    <input type="password" name="confirmPassword" placeholder="Повторите новый пароль"/><br/>
    <button type="submit">Сохранить пароль</button>
</form>

<hr/>

<h2>Ваше фото</h2>

<div th:if="${user.photoFilename == null}">
    <p>Фото ещё не загружено</p>
</div>

<div th:if="${user.photoFilename != null}">
    <img th:src="@{'/uploads/' + ${user.photoFilename}}" alt="photo" width="200"/>
</div>

<h3>Загрузить новое фото</h3>
<form th:action="@{/profile/upload}" method="post" enctype="multipart/form-data">
    <input type="file" name="file"/>
    <button type="submit">Загрузить</button>
</form>

</body>
</html>
